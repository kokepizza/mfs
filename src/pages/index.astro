---
import Layout from '../layouts/Layout.astro';
import Image from 'astro/components/Image.astro';
import { projects } from '../data/projects';

const imageImports = await Promise.all(
  projects.flatMap((project) => project.images).map((path) => import(`../${path}`))
);

// Crea un Map con path â†’ img para usar en el render
const imageMap = new Map();
imageImports.forEach((img, i) => {
  const path = projects.flatMap(p => p.images)[i];
  imageMap.set(path, img.default);
});
---

<Layout>

  <div class="title-name">
    <a href="/">
      <h1>Marc Flaquer</h1>
    </a>
  </div>

  <div class="h-screen w-screen overflow-y-scroll snap-y snap-mandatory">
    {projects.map((project) => (
      <Image
        src={imageMap.get(project.images[0])}
        alt={project.name}
        class="h-screen w-screen object-cover snap-start"
        loading="lazy"
      />
    ))}
  </div>

  <style>
    .title-name {
      position: fixed;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      font-family: 'ABC Diatype', sans-serif;
      font-weight: 900;
      font-size: 15vw;
      white-space: nowrap;
      z-index: 10;
      mix-blend-mode: difference;
      pointer-events: none;
    }

    @media (min-width: 1024px) {
      .title-name {
        top: 50%;
        transform: translate(-50%, -50%);
        font-size: 5vw;
      }
    }
  </style>

</Layout>